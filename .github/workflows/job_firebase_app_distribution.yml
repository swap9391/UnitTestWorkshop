name: Deploy To Firebase App Distribution

on:
  workflow_dispatch:
    inputs:
      release_notes:
        type: string
        required: true
        default: 'UnitTestWorkshop Debug build to distribute on Firebase app distribution'
        description: 'Release Notes'
      version_name:
        type: number
        required: true
        description: 'Enter the Version Number for this build (float)'


jobs:
    build:
      name: Building and distributing app on Debug variant
      runs-on: ubuntu-latest

      steps:
        - uses: actions/checkout@v3

        - uses: actions/setup-java@v3
          with:
            distribution: 'temurin'
            java-version: '17'

        - name: Setup Gradle
          uses: gradle/gradle-build-action@v2

        - name: Make gradlew executable
          run: chmod +x ./gradlew

        - name: Execute Gradle command - assembleDebug
          run: ./gradlew assembleDebug

        - name: upload artifact to Firebase App Distribution
          uses: wzieba/Firebase-Distribution-Github-Action@v1
          with:
            appId: ${{secrets.FIREBASE_APP_ID}}
            serviceCredentialsFileContent: ${{ secrets.CREDENTIAL_FILE_CONTENT }}
            groups: my-tester
            file: app/build/outputs/apk/debug/app-debug.apk
            releaseNotes: ${{inputs.release_notes}}
            versionName: ${{inputs.version_name }} # Use the input versionName
